package com.wally.test;

import java.util.regex.Pattern;

public class NumberEncoder 
{
	private final static String[][] SOURCE = 
		{{"4877256816","4018025817","7157582926","1113401467","1526175145","8966511691","2565284040","6903721233","8745748357","4752743240"},
		{"9308760616","9082627415","4558140918","4135330184","3124934169","1177979842","8694391921","3428165635","5320424950","9783942687"},
		{"4598562263","9635948892","9486285943","7241401165","9434782365","2249518228","6050295609","4391242723","8072948864","4717813706"},
		{"3391464810","4289874633","6364746328","8570454151","9345573019","6617767871","9537580260","8538613000","3851404317","8006037608"},
		{"2010908103","1122706496","2531841532","3433259372","2590087888","4902508123","1712209758","9953321286","7079184004","1541848964"},
		{"9512464257","7274168853","3392983573","1862715870","9988108239","1221772501","4738876264","1093580027","6324958964","9521762207"},
		{"3259778381","7735688190","8924816170","3608750765","3377901485","9894053843","6635094438","5734954829","7421585788","6275879679"},
		{"4137382829","8116153897","8588698827","2123081527","3011391270","1358619820","5712328573","6899435779","6468736576","3071438086"},
		{"3133208292","7664087432","7620763317","6421810160","2799198518","7719536339","5881739548","9587154870","9662906425","8986445131"},
		{"4640474821","6942234697","4665326165","2717157008","2856010095","3248181508","1341731619","9801682604","8246630580","4376169698"},
		{"1421507269","3333244004","4794258317","2416157573","7885158216","6349753792","8520082721","4880687625","1345149400","5005128863"},
		{"2468361345","3730072480","8229880190","7663381739","3228786125","4031667837","2151077926","1323173421","7430695543","7541092400"},
		{"5011855256","8863550347","3022925588","7349144988","4073588355","7727790153","1931857780","1620923376","9699801161","8382067870"},
		{"6796754641","3244447053","5010028587","9094688012","7106691859","8201612708","6605731202","1068563578","4516510978","8384129267"},
		{"2246664517","9113085753","6377413266","2657332807","3168736200","6446952388","4408373380","5884067405","8306789800","5518112088"},
		{"5631269346","1670493572","8629591505","7554444868","8625834945","2736485483","4132086012","5677115611","9165110665","1792404076"},
		{"1523197368","2023847997","1298069398","4431453148","3379562063","8763923541","1870181222","6720947383","9438510445","3601315671"},
		{"2481070477","9488219602","7798122811","1200728175","1759363030","4191978770","3832784375","7683529849","7625922057","8416281623"},
		{"5702580005","9226886717","7567150951","5885582023","3140379377","2503961804","1969117272","8287754476","1436705014","7408221622"},
		{"7670603345","2204603205","2880566175","5934737574","3466123328","3439689007","5067326121","9424783007","5350323289","3443346515"},
		{"3074416631","2963506542","6764261515","7157138722","1964663806","1280965678","7229823240","7505503720","6403151967","6196618276"},
		{"5172664554","7173867889","2477932988","1233831193","7026558674","3041105698","5329104151","4193874938","1719722515","3244785388"},
		{"9329757760","8086184772","8038066672","8402793858","1977204563","8655809499","2030958664","5641753736","5803906080","5229169383"},
		{"2397777724","5293760609","3622470984","5499168441","5859718169","2660590778","5112957232","4928539253","4126563429","5761140534"},
		{"5673279921","3252062908","7902595059","2422591507","6665526272","1400885131","7482768886","1864926485","3723187540","6865522740"},
		{"9351984471","2590123091","6605833743","2980648134","8295983115","9480301647","8907668695","5944927004","6511982548","7843271869"},
		{"4071990826","9970264794","1196482000","9118164076","5614175246","6082706422","4063902321","7948805109","1960233451","9312529007"},
		{"7846955138","8737111990","5920471101","3258413185","8425805946","5078622170","2552876534","1568046094","5220594269","9945272428"},
		{"1912822041","8243100834","8672967163","5210420789","2488314536","3456419677","7493926952","4965045848","8466487510","9366843410"},
		{"6444966402","9643232664","9654943099","2565356004","4475573373","6744512407","1287657051","6671691145","7114441052","8848908931"},
		{"3068082891","4380990037","2060091386","2540062390","1577271075","4161012168","3526927669","9211034819","9556829733","9270379374"}};
	
	public NumberEncoder() 
	{
	}
	
	
	/**
	 * 数字加密
	 * 加密规则：输入进来的数值和个位数对应码表中的列数；
	 *        其各个数字分别对应该列数字的第几位。
	 * @param input
	 * @return 加密后的结果
	 */
	public final static String  encodeNumber(String input) throws Exception 
	{
		if(input == null || input.equals(""))
		{
			throw new IllegalArgumentException("您传入的字符串为空！");
		}
		else
		{
			int column = 0;
			String result = "";
			
			// 判断字符串是否合法
			Pattern pattern = Pattern.compile("[0-9]*"); 
			boolean b = pattern.matcher(input).matches();
			if(b)
			{
				// 获取取值的列数
				column = sumEndValue(input);
				
				result = parseIndexValue(input, column);
				
				return result;
			}
			else
			{
				throw new IllegalArgumentException("你传入的字符串不合法!");
			}
		}
		
	}
	
	
	
	/**
	 * 返回和的个位数值
	 * @param input
	 * @return
	 */
	private static int sumEndValue(String str)
	{
		Integer sum = 0;
		for (int i = 0; i < str.length(); i++)		
		{			
			char c = str.charAt(i);//每一位字符		
			sum += Integer.parseInt(Character.toString(c)); //求和	
		}
		String sumStr = sum.toString();
		char value = sumStr.charAt(sumStr.length()-1);
		return Integer.parseInt(Character.toString(value));
	}
	
	
	/**
	 * 通过列获取每个码表对应列上面的数值
	 * @param str
	 * @param column
	 * @return 加密后的结果
	 */
	private static String parseIndexValue(String str,int column)
	{
		String result = "";
		for (int i = 0; i < str.length(); i++)		
		{
			String indexStr = SOURCE[i][column];
			char c = str.charAt(i);//每一位字符	
			Integer index = Integer.parseInt(Character.toString(c)); 
			char value = indexStr.charAt(index);
			result = result + value;
		}
		return result;
	}
	
	public static void main(String[] args) 
	{
		try {
			System.out.println(encodeNumber("123456789"));
			System.out.println(encodeNumber("45656555555555555483231255232655656565656565555555555555"));
		} catch (Exception e) {
			System.out.println(e.getMessage());
		}
	}

}
